---

- name: Install nfs-dependencies
  package:
    name:
      - nfs-common

- name: mkdir /usr/local
  file:
    path: /usr/local
    state: directory
    owner: root
    group: sysadmin

- name: unmount /usr/local NFS volume 
  ansible.posix.mount:
    path: /usr/local
    state: unmounted



- name: Mount /usr/local NFS volume 
  ansible.posix.mount:
    src: systemfileshare.blob.core.windows.net:/systemfileshare/local
    path: /usr/local
    opts: sec=sys,vers=3,nolock,proto=tcp
    state: mounted
    fstype: nfs


- name: mkdir /home/nfs/
  file:
    path: /home/nfs/
    state: directory
    owner: root
    group: root

- name: unmount /home/nfs NFS volume 
  ansible.posix.mount:
    path: /home/nfs
    state: unmounted


- name: Mount /home NFS volume 
  ansible.posix.mount:
    src: homesfileshare.file.core.windows.net:/homesfileshare/home1
    path: /home/nfs/
    opts: vers=4,minorversion=1,sec=sys
    state: mounted
    fstype: nfs



- name: mkdir /scratch
  file:
    path: /scratch
    state: directory
    owner: root
    group: sysadmin

- name: unmount /scratch NFS volume 
  ansible.posix.mount:
    path: /scratch
    state: unmounted



- name: Mount /scratch NFS volume 
  ansible.posix.mount:
    src: systemfileshare.blob.core.windows.net:/systemfileshare/scratch
    path: /scratch
    opts: sec=sys,vers=3,nolock,proto=tcp
    state: mounted
    fstype: nfs
